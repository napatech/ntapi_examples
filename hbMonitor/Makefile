# ------------------------------------------------------------------------
# Standalone makefile Norm Burke 03-23-12
# ------------------------------------------------------------------------

EXEC = hbMonitor
SRCS = hbMonitor.c

# ------------------------------------------------------------------------
# Install Path
# ------------------------------------------------------------------------
INSTALL_PATH = /opt/napatech3

# ------------------------------------------------------------------------
# Setup Defines
# ------------------------------------------------------------------------
DEFINES += -D_NTAPI_EXTDESCR_ALL_

# ------------------------------------------------------------------------
# Include Directory and Compile Flags
# ------------------------------------------------------------------------
CFLAGS += -I$(INSTALL_PATH)/include
CFLAGS += -O2 -g -std=gnu99
CFLAGS += -Wall -Wextra -Wstrict-prototypes -Wcast-qual -Winline
CFLAGS += -Wsign-compare -Wunused-parameter -Wpointer-arith -Wshadow

# ------------------------------------------------------------------------
# Check for 32/64bit to enable optimal GCC architecture
# ------------------------------------------------------------------------
SUBARCH := $(shell uname -m)
ifeq ($(findstring 64,$(SUBARCH)),64)
CFLAGS += -march=nocona
else
CFLAGS += -march=prescott
endif

# ------------------------------------------------------------------------
# Library Directory and Libaries
# ------------------------------------------------------------------------
LFLAGS += -L$(INSTALL_PATH)/lib
LFLAGS += -L./../lib
LFLAGS += -L /usr/local/lib
LFLAGS += -lntapi
LFLAGS += -lstdc++
LFLAGS += -lncurses

# ------------------------------------------------------------------------
$(EXEC) : $(SRCS)
# ------------------------------------------------------------------------
	exec clear
	gcc -o $(EXEC) $(SRCS) $(DEFINES) $(CFLAGS) $(LFLAGS)

# ------------------------------------------------------------------------
test : $(EXEC)
# ------------------------------------------------------------------------
	exec clear
	./$(EXEC) -v 0 -p 100

# ------------------------------------------------------------------------
clean :
# ------------------------------------------------------------------------
	rm -f *.o $(EXEC) *.ntcap

# ------------------------------------------------------------------------
.PHONY: clean
# ------------------------------------------------------------------------
	
